{% extends "home.html" %}
{% block extra_ga %}
{% if form.is_valid %} _gaq.push(['_trackEvent', 'click', 'heatmap', 'address', '{{ data.address }}']);
{% endif %}
{% endblock %}

{% block output %}

<div class="row-fluid" id="output-block">
	 {% if form.is_valid %} {% if data.lat and data.lng %}
	<div id="img-block" class="span2">
		<img id="map"/>
	</div>
	<div class="span10">
		<h4 id="place-block">{{ data.place }}</h4>
		<div id="output-text">
			 {% include "_chance.html" %}
		</div>
		<div id="block-share">
			</br>
			<strong>Share:</strong>
			<div>
				<span id='share-middle-text'>I just found out that the chance of getting a parking ticket at {{ data.place }} is {{ data.chance|floatformat:1 }}% per hour.
                    Try it out for any address in San Francisco.</span>
			</div>
			<div class="span3" id="middle-share">
				<a href="https://www.facebook.com" onclick="fb_top('fb-middle-link','#share-middle-text')" id="fb-middle-link" target="_blank">
				<img src="/static/img/btn_facebook.png"></a>
				<a href="https://twitter.com/" onclick="twitter_top('tweeter-middle-link','#share-middle-text')" id="tweeter-middle-link" target="_blank">
				<img src="/static/img/btn_twitter.png"></a>
				<a href="https://plus.google.com" onclick="googleone_top('googleone-middle-link')" id="googleone-middle-link" target="_blank">
				<img src="/static/img/btn_google_plusone.png"></a>
			</div>
		</div>
	</div>
</div>
<div class="row-fluid" id="output-table">
	<div class="span6">
		<h5>Tickets ({{ data.tickets_heatmap_count }})</h5>
		<table class="table table-slim table-bordered" id="tickets-heatmap">
		 {% with data.tickets_heatmap as heatmap %}{% include "_heatmap.html" %}{% endwith %}
		</table>
	</div>
	<div class="span6">
		<h5>Patrols ({{ data.paths_heatmap_count }})</h5>
		<table class="table table-slim table-bordered" id="paths-heatmap">
		 {% with data.paths_heatmap as heatmap %}{% include "_heatmap.html" %}{% endwith %}
		</table>
	</div>
</div>
</div>
<script>
                    var heatmap_options = {
                        colorArray: [
                            "#63BE7B",
                            "#FBE983",
                            "#F8696B"
                        ],
                        nullColor: "#63BE7B",
                        readValue: function (e) {
                            return ($(e).children("a").html())
                        }
                    }
                    $("#paths-heatmap td").hottie(heatmap_options);
                    $("#paths-heatmap th.column-total").hottie(heatmap_options);
                    $("#paths-heatmap th.row-total").hottie(heatmap_options);
                    $("#tickets-heatmap td").hottie(heatmap_options);
                    $("#tickets-heatmap th.column-total").hottie(heatmap_options);
                    $("#tickets-heatmap th.row-total").hottie(heatmap_options);
                </script>
 {% else %} Sorry, we cannot find coordinates of this address. {% endif %} {% endif %}
</div>

{% endblock %}